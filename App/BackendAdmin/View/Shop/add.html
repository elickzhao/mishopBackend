<!DOCTYPE HTML>
<html>

<head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
        content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="Bookmark" href="/favicon.ico">
    <link rel="Shortcut Icon" href="/favicon.ico" />
    <!--[if lt IE 9]>
    <script type="text/javascript" src="__PUBLIC__/admin/lib/html5shiv.js"></script>
    <script type="text/javascript" src="__PUBLIC__/admin/lib/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/admin/static/h-ui/css/H-ui.min.css" />
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/admin/static/h-ui.admin/css/H-ui.admin.css" />
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/admin/lib/Hui-iconfont/1.0.8/iconfont.css" />
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/admin/static/h-ui.admin/skin/default/skin.css" id="skin" />
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/admin/static/h-ui.admin/css/style.css" />
    <link rel="stylesheet" href="__PUBLIC__/admin/css/common.css">
    <link rel="stylesheet" href="__PUBLIC__/admin/lib/layui/css/layui.css">
    <!--[if IE 6]>
    <script type="text/javascript" src="__PUBLIC__/admin/lib/DD_belatedPNG_0.0.8a-min.js" ></script>
    <script>DD_belatedPNG.fix('*');</script>
    <![endif]-->
    <style>
        .layui-table-cell {
            height: inherit;
        }

        .layui-table-cell a {
            text-decoration: none;
        }

        #commentForm .layui-form-label {
            text-align: left;
        }
    </style>
    <title>新增广告</title>
</head>

<body>
    <!-- 导航 -->
    <include File='Page/nav' />
    <!-- /导航 -->
    <div class="page-container">
        <div class="panel panel-default mt-40">
            <div class="panel-header">{$bc[1]}</div>
            <div class="panel-body">

                <form class="form form-horizontal layui-form" action="{:U('save')}" method="post" id="commentForm"
                    enctype="multipart/form-data">
                    <!-- 店名 -->
                    <div class="row cl">
                        <div class="col-xs-4 col-sm-2 ml-30">
                            <label class="layui-form-label">店名：</label>
                        </div>
                        <div class="formControls col-xs-8 col-sm-4">
                            <input type="text" class="input-text" placeholder="店名. 必填字段!" name="name" id="name"
                                value="{$shop_info.name}" minlength="2" required>
                        </div>
                        <label class="layui-form-label">
                            <span class="c-red text-l">*</span>
                        </label>
                    </div>
                    <!-- /店名 -->
                    <div class="hr-line-dashed"></div>


                    <!-- 地址-->
                    <div class="row cl">
                        <div class="col-xs-4 col-sm-2 ml-30">
                            <label class="layui-form-label">地址：</label>
                        </div>
                        <div class="formControls col-xs-8 col-sm-4">
                            <input type="text" class="input-text" placeholder="地址.必填字段!" name="address" id="address"
                                value="{$shop_info.address}" minlength="5" required>
                        </div>
                        <label class="layui-form-label">
                            <span class="c-red text-l">*</span>
                        </label>
                    </div>
                    <!-- /地址 -->
                    <div class="hr-line-dashed"></div>

                    <!-- 联系人 -->
                    <div class="row cl">
                        <div class="col-xs-4 col-sm-2 ml-30">
                            <label class="layui-form-label">联系人：</label>
                        </div>
                        <div class="formControls col-xs-8 col-sm-4">
                            <input type="text" class="input-text" placeholder="联系人. 必填字段!" name="contact" id="contact"
                                value="{$shop_info.contact}" minlength="2" required>
                        </div>
                        <label class="layui-form-label">
                            <span class="c-red text-l">*</span>
                        </label>
                    </div>
                    <!-- /联系人 -->

                    <div class="hr-line-dashed"></div>

                    <!-- 联系电话 -->
                    <div class="row cl">
                        <div class="col-xs-4 col-sm-2 ml-30">
                            <label class="layui-form-label">联系电话：</label>
                        </div>
                        <div class="formControls col-xs-8 col-sm-4">
                            <input type="text" class="input-text" placeholder="联系电话. 必填字段!" name="phone" id="phone"
                                value="{$shop_info.phone}" minlength="5" maxlength="20" required>
                        </div>
                        <label class="layui-form-label">
                            <span class="c-red text-l">*</span>
                        </label>
                    </div>
                    <!-- /联系电话 -->


                    <div class="hr-line-dashed"></div>

                    <!-- 商品分类  -->
                    <div class="row cl">
                        <div class="col-xs-4 col-sm-2 ml-30">
                            <label class="layui-form-label">选择分类：</label>
                        </div>
                        <div class="formControls col-xs-8 col-sm-6">
                            <div class="layui-inline">
                                <!-- 这个宽度在不同浏览器大小会受到影响 以后看看解决 -->
                                <div class="layui-input-inline" style="width: 16rem;">
                                    <select class="lay-search" name="province" id="cateid" lay-filter="cid_1" lay-search
                                        lay-verify="cateid">
                                        <option value>省/直辖市</option>
                                        <volist name="cate_list" id="v">
                                            <option value="{$v.id}" <if condition="$v.id eq $shop_info['province']">
                                                selected="selected"</if>>{$v.name}</option>
                                        </volist>
                                    </select>
                                </div>

                                <div class="layui-input-inline" style="width: 16rem;">
                                    <?php if($city_list) { ?>
                                    <select class="inp_1" name="city" id="cid" lay-filter="cid_2" lay-search
                                        lay-verify="cateid">
                                        <option value>市</option>
                                        <volist name="city_list" id="v">
                                            <option value="{$v.id}" <if condition="$v.id eq $shop_info['city']">
                                                selected="selected"</if>>{$v.name}</option>
                                        </volist>
                                    </select>

                                    <?php } else { ?>
                                    <select class="inp_1" name="city" id="cid" lay-filter="cid_2" lay-search
                                        lay-verify="cateid">
                                        <option value>市</option>
                                    </select>
                                    <?php } ?>
                                </div>
                                <div class="layui-input-inline" style="width: 16rem;">
                                    <?php if($district_list) { ?>
                                    <select class="inp_1" name="district" id="cid_3" lay-filter="cid_3" lay-search
                                        lay-verify="cateid">
                                        <option value>县/区</option>
                                        <volist name="district_list" id="v">
                                            <option value="{$v.id}" <if condition="$v.id eq $shop_info['district']">
                                                selected="selected"</if>>{$v.name}</option>
                                        </volist>
                                    </select>

                                    <?php } else { ?>
                                    <select class="inp_1" name="district" id="cid_3" lay-filter="cid_3" lay-search
                                        lay-verify="cateid">
                                        <option value>县/区</option>
                                    </select>
                                    <?php } ?>
                                </div>
                            </div>

                            <span class="help-block ">
                                <i class="Hui-iconfont c-danger">&#xe6e0;</i>
                                <cite class="c-999">必选项.没有二级栏目,请先添加二级栏目,否则无法发布</cite>
                            </span>
                        </div>
                        <label class="layui-form-label">
                            <span class="c-red text-l">*</span>
                        </label>
                    </div>
                    <!-- /商品分类 -->


                    <div class="hr-line-dashed"></div>

                    <!-- 配送范围-->
                    <div class="row cl">
                        <div class="col-xs-4 col-sm-2 ml-30">
                            <label class="layui-form-label">经纬度：</label>
                        </div>
                        <div class="formControls col-xs-8 col-sm-4">
                            <input type="text" class="input-text" placeholder="配送范围" name="lnglat" id="lnglat"
                                lay-verify="lnglat" value="<?php echo $shop_info['lnglat']; ?>" disabled>
                            <input type="hidden" name="longitude" id="longitude"
                                value="<?php echo $shop_info['longitude']; ?>">
                            <input type="hidden" name="latitude" id="latitude"
                                value="<?php echo $shop_info['latitude']; ?>">
                            <span class="help-block ">
                                <i class="Hui-iconfont c-danger">&#xe6e0;</i>
                                <cite class="c-999">&nbsp;默认仓库发货</cite>
                                <!-- onclick="win_open('{:U('get_pro')}',1280,800)" -->
                                <input type="button" value="选择经纬度" class="btn btn-link" onclick="oo()">
                            </span>
                        </div>
                        <label class="layui-form-label">
                            <span class="c-red text-l">*</span>
                        </label>
                    </div>
                    <!-- /配送范围-->

                    <div class="hr-line-dashed"></div>

                    <!-- 排序-->
                    <div class="row cl">
                        <div class="col-xs-4 col-sm-2 ml-30">
                            <label class="layui-form-label">排序：</label>
                        </div>
                        <div class="formControls col-xs-8 col-sm-4">
                            <input type="text" class="input-text" placeholder="排序" name="sort" id="sort"
                                value="<?php echo ($shop_info['sort']) ?  $shop_info['sort'] : 0 ?>">
                        </div>
                    </div>
                    <!-- /排序-->


                    <div class="hr-line-dashed"></div>

                    <div class="row cl">
                        <div class="col-xs-8 col-sm-9 col-xs-offset-4 col-sm-offset-2">
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            <input class="btn btn-primary radius" lay-submit lay-filter="*" type="submit" name="submit"
                                value="&nbsp;&nbsp;提交&nbsp;&nbsp;">
                            <input type="hidden" name="adv_id" id="adv_id" value="<?php echo $shop_info['id']; ?>">
                        </div>
                    </div>
                </form>

            </div>
        </div>
    </div>

    <!-- 底部 -->
    <div style="position:fixed; bottom:0; width:100%">
        <include File='Page/footer' />
    </div>
    <!-- /底部 -->

    <script>
        var form = layui.form;
        $("#commentForm").validate({
            rules: {
                sort: {
                    number: true
                },
                phone: {
                    number: true
                }
            }
        });

        /*=============================================
        =            分类二级联动                      =
        =============================================*/
        form.on('select(cid_1)', function (data) {
            var cateid = data.value;
            $.post('{:U("getcid")}', {
                cateid: cateid,
                async: false,
            }, function (data) {
                if (data.catelist != '') {
                    var htmls = '<option value="">市</option>';
                    var cate = data.catelist;

                    $(cate).each(function (v, k) {
                        htmls += "<option value='" + k.id + "'>" + k.name +
                            "</option>";
                    });

                    $('#cid').html(htmls);
                    form.render('select'); //这里只有这么写才可以 看来某些东西冲突了
                } else {
                    $('#cid').html('<option value="">市</option>');
                    form.render('select');
                }
            }, "json");
        });
        /*=====  End of 分类二级联动  ======*/
        /*=============================================
        =            分类三级联动                      =
        =============================================*/
        form.on('select(cid_2)', function (data) {
            var cateid = data.value;
            $.post('{:U("getcid")}', {
                cateid: cateid,
                async: false,
            }, function (data) {
                if (data.catelist != '') {
                    var htmls = '<option value="">县/区</option>';
                    var cate = data.catelist;

                    $(cate).each(function (v, k) {
                        htmls += "<option value='" + k.id + "'>" + k.name +
                            "</option>";
                    });

                    $('#cid_3').html(htmls);
                    form.render('select'); //这里只有这么写才可以 看来某些东西冲突了
                } else {
                    $('#cid_3').html('<option value="">县/区</option>');
                    form.render('select');
                }
            }, "json");
        });
        /*=====  End of 分类三级联动  ======*/

        //自定义验证规则  
        form.verify({
            cateid: function (value) {
                if (value == "") {
                    //滚动到指定元素位置 //可能是因为iframe的关系 只能指定高度了 而不能指定元素
                    //console.log($("#cid").offset().top);
                    $('html, body').scrollTop(100);
                    return "必须选择地区";
                }
            },
            lnglat: function (value) {
                if (value == "") {
                    $('html, body').scrollTop(100);
                    return "必须选择经纬度";
                }
            }
        });


        function oo() {
            layer.open({
                type: 2,
                title: '选择经纬度',
                area: ['1280px', '800px'],
                fixed: false, //不固定
                maxmin: true,
                shadeClose: true,
                content: "{:U('get_location')}"
            });
        }
    </script>


</body>

</html>